<!-- templates/poem_view.html -->
<!doctype html>
<html>
<body>
<p><a href="/poems">Back to poems</a></p>

{% if logged_in %}
<p>Logged in as <b>{{ username }}</b></p>
<form method="post" action="/logout"><button>Logout</button></form>
{% else %}
<a href="/login">Login</a>
{% endif %}

<h1>{{ poem.title }}</h1>
<p>by {{ poem.author }}</p>
<pre>{{ poem.body }}</pre>

{% if can_edit %}
  <form style="display:inline" method="post" action="/poems/{{ poem.id }}/publish">
  <button type="submit">Publish</button>
  </form>
<form method="post" action="/poems/{{ poem.id }}/delete">
<button>Delete poem</button>
</form>
{% endif %}

<h2>Comments</h2>

{% for c in comments %}
<p>
  <b>{{ c.author }}</b> â€” {{ c.time_ago }}<br>
  {{ c.body }}
</p>
{% endfor %}

{% if logged_in %}
<form method="post" action="/poems/{{ poem.id }}/comments">
  <!-- honeypot (bots tend to fill this; humans never see it) -->
  <input type="text" name="website" style="display:none" tabindex="-1" autocomplete="off">

  <textarea name="body"></textarea><br>
  <button>Post comment</button>
</form>
{% else %}
<p><a href="/login">Login to comment</a></p>
{% endif %}
</body>
</html>
